/**
 * @file src/app/dashboard/as-is-analysis/components/WritingGuideModal.tsx
 * @description
 * AS-IS 분석 템플릿 작성 가이드 모달 컴포넌트입니다.
 * 마크다운 형식의 작성 가이드를 표시합니다.
 *
 * 초보자 가이드:
 * 1. **모달 구조**: 오버레이 + 스크롤 가능한 콘텐츠 영역
 * 2. **마크다운 렌더링**: react-markdown 사용
 * 3. **닫기**: ESC 키 또는 X 버튼, 오버레이 클릭
 */

"use client";

import { useEffect } from "react";
import ReactMarkdown from "react-markdown";
import remarkGfm from "remark-gfm";
import { Icon, Button } from "@/components/ui";

interface WritingGuideModalProps {
  /** 모달 닫기 핸들러 */
  onClose: () => void;
}

/**
 * AS-IS 작성 가이드 마크다운 콘텐츠
 * 원본 파일: C:\Users\hsyou\Desktop\ASIS-TEMPLATE-WRITING-GUIDE-v2.md
 */
const GUIDE_CONTENT = `# AS-IS 분석 템플릿 작성 가이드

## 📋 목차

1. [개요](#1-개요)
2. [총괄 템플릿 작성 가이드](#2-총괄-템플릿-작성-가이드)
3. [단위업무 템플릿 작성 가이드](#3-단위업무-템플릿-작성-가이드)
4. [작성 순서 및 팁](#4-작성-순서-및-팁)

---

# 1. 개요

## 1.1 AS-IS 분석이란?

AS-IS 분석은 **현재 상태(Current State)**를 파악하는 것입니다.
새로운 시스템을 구축하기 전에 "지금 어떻게 일하고 있는지"를 명확히 정리합니다.

## 1.2 왜 AS-IS 분석이 필요한가?

| 목적 | 설명 |
|-----|------|
| **현황 파악** | 현재 업무가 어떻게 돌아가는지 이해 |
| **문제점 발견** | 비효율, 중복, 누락 등 이슈 식별 |
| **요구사항 도출** | TO-BE(미래 상태) 설계의 기초 자료 |
| **Gap 분석** | AS-IS와 TO-BE의 차이 파악 |

## 1.3 템플릿 구조

\`\`\`
┌─────────────────────────────────────────────────────────────────────┐
│                      📊 총괄 템플릿 (1개)                            │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │ 업무 분류 체계                                                │    │
│  │                                                              │    │
│  │  ※ 업무명(단위업무) 단위로 1행 = 1 단위업무 템플릿             │    │
│  │                                                              │    │
│  │  #1 자재관리 > 입고관리 > 입고예정등록 ───→ 📋 단위업무 #1    │    │
│  │  #2 자재관리 > 입고관리 > 검수         ───→ 📋 단위업무 #2    │    │
│  │  #3 자재관리 > 입고관리 > 입고확정     ───→ 📋 단위업무 #3    │    │
│  │  #4 자재관리 > 출고관리 > 출고요청     ───→ 📋 단위업무 #4    │    │
│  │  ...                                                         │    │
│  └─────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────┘
                                   ↓
┌─────────────────────────────────────────────────────────────────────┐
│           📋 단위업무 템플릿 (N개, 업무명 단위로 각각 1개)            │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │ [공통 필수]                                                  │    │
│  │  • 업무 프로세스 정의서 (해당 업무의 세부 Step)               │    │
│  │  • 업무 프로세스 맵 (Flow Chart / Swimlane)                  │    │
│  │  • R&R 정의                                                 │    │
│  │  • 인터뷰 결과                                               │    │
│  │  • 이슈/Pain Point                                          │    │
│  ├─────────────────────────────────────────────────────────────┤    │
│  │ [조건부] 현행 방식에 따라 선택                                 │    │
│  │  • (A) 수기/엑셀: 문서목록, 구조분석                          │    │
│  │  • (B) 시스템: 기능, 화면, I/F, 테이블, 코드                  │    │
│  └─────────────────────────────────────────────────────────────┘    │
└─────────────────────────────────────────────────────────────────────┘
\`\`\`

## 1.4 분류 체계 (3단계)

\`\`\`
대분류 (업무 영역)
  └─ 중분류 (업무 그룹)
       └─ 업무명 (단위업무) ←── ⭐ 단위업무 템플릿 작성 단위
            └─ 세부 Step (단위업무 템플릿 내에서 상세화)
\`\`\`

**예시:**
\`\`\`
자재관리 (대분류)
  └─ 입고관리 (중분류)
       ├─ 입고예정등록 (업무명) → 📋 단위업무 템플릿 #1
       │    └─ Step: 발주서확인 → 예정일입력 → 품목입력 → 저장
       │
       ├─ 검수 (업무명)         → 📋 단위업무 템플릿 #2
       │    └─ Step: 거래명세서확인 → 수량검수 → 외관검수 → 결과기록
       │
       └─ 입고확정 (업무명)     → 📋 단위업무 템플릿 #3
            └─ Step: 검수결과확인 → 입고확정 → 라벨발행 → ERP연동
\`\`\`

> ⭐ **핵심**: 단위업무 템플릿은 **업무명(단위업무)** 하나당 1개씩 작성합니다.

---

# 2. 총괄 템플릿 작성 가이드

## 2.1 프로젝트 기본 정보

### 작성 목적
프로젝트 식별을 위한 기본 정보를 기록합니다.

### 작성 항목

| 항목 | 설명 | 예시 |
|-----|------|------|
| 프로젝트명 | 프로젝트 공식 명칭 | ㅇㅇ전자 MES V2 구축 |
| 고객사 | 고객사/사업장 명칭 | ㅇㅇ전자 평택사업장 |
| 작성일 | 문서 작성일 | 2025-01-18 |
| 작성자 | 담당 PMO/컨설턴트 | 홍길동 |

---

## 2.2 업무 분류 체계

### 작성 목적
분석 대상인 **모든 단위업무를 목록화**하고, 각 업무의 현행 방식과 이슈를 요약합니다.

### 대분류 옵션

| 대분류 | 포함 업무 예시 |
|-------|--------------|
| 자재관리 | 입고, 출고, 반품, 재고실사 |
| 생산관리 | 생산계획, 작업지시, 실적등록, 공정관리 |
| 품질관리 | 수입검사, 공정검사, 출하검사, 불량관리 |
| 설비관리 | 설비등록, 예방보전, 고장관리, 가동현황 |
| 재고관리 | 재고현황, 재고이동, 재고조정 |
| 출하관리 | 출하지시, 출하검수, 배송관리 |
| 기타 | 위에 해당하지 않는 업무 |

### 현행 방식 옵션

| 현행 방식 | 설명 | 예시 |
|----------|------|------|
| 수기 | 종이, 대장, 전표로 관리 | 입고대장 수기 작성 |
| 엑셀 | Excel 파일로 관리 | 입고현황.xlsx 사용 |
| 시스템 | 기존 시스템 사용 | ERP, 레거시 MES |
| 혼합 | 2가지 이상 병행 | ERP + 엑셀 병행 |

### 작성 예시

> ⭐ **1행 = 1 단위업무(업무명) = 1 단위업무 템플릿**

| No | 대분류 | 중분류 | **업무명** | 현행방식 | 이슈 요약 | 단위업무 |
|----|-------|-------|----------|---------|----------|---------|
| 1 | 자재관리 | 입고관리 | **입고예정등록** | 엑셀 | 수작업 입력, 버전관리 안됨 | 📋 #1 → |
| 2 | 자재관리 | 입고관리 | **검수** | 수기 | 수기 체크리스트, 이력추적 불가 | 📋 #2 → |
| 3 | 자재관리 | 입고관리 | **입고확정** | 엑셀 | ERP 이중입력, 실시간 반영 안됨 | 📋 #3 → |
| 4 | 자재관리 | 입고관리 | **라벨발행** | 시스템 | 별도 프로그램, 데이터 재입력 | 📋 #4 → |
| 5 | 자재관리 | 출고관리 | **출고요청접수** | 엑셀 | 요청서 양식 불일치 | 📋 #5 → |
| 6 | 자재관리 | 출고관리 | **피킹** | 수기 | 피킹리스트 수기 작성 | 📋 #6 → |
| 7 | 자재관리 | 출고관리 | **출고확정** | 혼합 | 엑셀+ERP 이중관리 | 📋 #7 → |
| 8 | 생산관리 | 생산계획 | **월간계획수립** | 엑셀 | 버전관리 어려움 | 📋 #8 → |
| 9 | 생산관리 | 생산계획 | **주간계획수립** | 엑셀 | 변경이력 추적 불가 | 📋 #9 → |
| 10 | 생산관리 | 생산계획 | **일일계획수립** | 엑셀 | 실시간 조정 어려움 | 📋 #10 → |
| 11 | 생산관리 | 작업지시 | **작업지시생성** | 시스템 | 레거시 시스템 느림 | 📋 #11 → |
| 12 | 생산관리 | 작업지시 | **작업배분** | 혼합 | 시스템+수기 병행 | 📋 #12 → |
| 13 | 품질관리 | 수입검사 | **검사요청** | 수기 | 요청서 수기 작성 | 📋 #13 → |
| 14 | 품질관리 | 수입검사 | **검사실시** | 수기 | 검사성적서 수기 작성 | 📋 #14 → |
| 15 | 품질관리 | 수입검사 | **합격판정** | 엑셀 | 판정 기록 엑셀 관리 | 📋 #15 → |

### 작성 팁

> ✅ **업무명(단위업무) 단위로 1행씩 작성하세요**
> - 1행 = 1업무 = 1 단위업무 템플릿
> - 같은 중분류라도 업무명이 다르면 다른 행으로

> ✅ **업무명은 동사로 끝나게**
> - 좋은 예: 입고예정등록, 검수, 입고확정
> - 나쁜 예: 입고예정, 수량, 확정

> ✅ **적절한 단위로 나누세요**
> - 너무 크게: "입고관리" 전체를 하나로 ❌
> - 너무 작게: "발주서 확인" 같은 세부 Step ❌
> - 적절하게: "입고예정등록", "검수", "입고확정" ✅

> ✅ **이슈 요약은 핵심만**
> - 상세 이슈는 단위업무 템플릿에서 작성
> - 여기는 한눈에 파악할 수 있는 요약만

---

# 3. 단위업무 템플릿 작성 가이드

**"검수" 업무를 예시로 전체 작성 방법을 설명합니다.**

---

## 3.1 대상 업무 정보

### 작성 목적
이 단위업무 템플릿이 어떤 업무에 대한 것인지 명시합니다.

### 작성 예시

| 항목 | 값 |
|-----|---|
| 대분류 | 자재관리 |
| 중분류 | 입고관리 |
| **업무명** | **검수** |
| 현행 방식 | 수기 |
| 작성일 | 2025-01-18 |

---

## 3.2 업무 프로세스 정의서

### 작성 목적
해당 단위업무(업무명) 내의 **세부 Step**을 순서대로 정의합니다.

### 작성 항목 설명

| 컬럼 | 설명 | 작성 팁 |
|-----|------|--------|
| 순서 | Step 수행 순서 | 시간순으로 번호 부여 |
| Step명 | 세부 작업 이름 | 동사로 끝나게 (예: ~확인, ~검수) |
| 담당 | 수행하는 사람/부서 | 구체적으로 (예: 창고팀 박사원) |
| 수행 방식/도구 | 어떻게 하는지 | 수기, 엑셀, 시스템명 등 |
| 입력 정보 | Step 수행에 필요한 정보 | 어디서 받아오는지 포함 |
| 출력 정보/결과 | Step 결과물 | 다음 Step으로 넘기는 것 |

### 작성 예시 (업무명: 검수)

| 순서 | Step명 | 담당 | 수행 방식/도구 | 입력 정보 | 출력 정보/결과 |
|-----|--------|-----|--------------|----------|--------------|
| 1 | 거래명세서 확인 | 창고팀 박사원 | 수기 (육안) | 거래명세서, 입고예정목록 | 확인 완료 체크 |
| 2 | 수량 검수 | 창고팀 박사원 | 수기 (체크리스트) | 실물 자재, 거래명세서 | 수량 일치/불일치 기록 |
| 3 | 외관 검수 | 창고팀 박사원 | 육안 검사 | 실물 자재, 검사 기준서 | 외관 양호/불량 기록 |
| 4 | 검수 결과 기록 | 창고팀 박사원 | 엑셀 입력 | 검수 체크리스트 | 검수현황.xlsx 업데이트 |
| 5 | 이상 시 구매팀 통보 | 창고팀 박사원 | 전화/메신저 | 검수 불일치 내역 | 구매팀 확인 요청 |

### 작성 팁

> ✅ **현재 상태 그대로 작성하세요**
> - "이렇게 하면 좋겠다"가 아니라 "지금 이렇게 하고 있다"를 기록
> - 비효율적이더라도 있는 그대로 작성

> ✅ **세부 Step을 구체적으로**
> - 단위업무(업무명) 안에서 실제로 어떤 작업들이 이루어지는지
> - 시간 순서대로 빠짐없이 기록

---

## 3.3 업무 프로세스 맵

### 3.3.1 Flow Chart와 Swimlane 선택 기준

| 방식 | 핵심 질문 | 언제 사용? |
|-----|----------|----------|
| **Flow Chart** | "**어떻게** 흐르나?" | 순서, 분기, 조건이 중요할 때 |
| **Swimlane** | "**누가** 하나?" | 여러 담당자 협업이 중요할 때 |

### 선택 가이드

\`\`\`
Q1. 이 업무에 여러 담당자가 관여하나요?
    ├─ YES → Q2로
    └─ NO → Flow Chart만 작성

Q2. 담당자 간 인계/협업이 중요한 포인트인가요?
    ├─ YES → Swimlane 작성 (Flow Chart는 선택)
    └─ NO → Flow Chart 작성 (Swimlane은 선택)

Q3. 분기 조건(예/아니오)이 복잡한가요?
    ├─ YES → Flow Chart 필수
    └─ NO → 둘 중 하나만 작성해도 OK
\`\`\`

### 실무 예시

| 업무명 | 권장 방식 | 이유 |
|-------|----------|-----|
| 검수 | **Flow Chart** | 합격/불합격 분기가 핵심 |
| 입고예정등록 | **Flow Chart** | 담당자 1명, 순서만 중요 |
| 입고확정 | **둘 다** | 창고팀→자재팀 협업 + 조건 분기 |
| 작업배분 | **Swimlane** | 여러 담당자 역할 구분이 핵심 |

---

### 3.3.2 Flow Chart 작성 가이드

#### 도형 범례

| 도형 | 이름 | 용도 | 예시 |
|-----|-----|-----|------|
| ◯ (둥근 사각형) | 시작/종료 | 프로세스의 시작과 끝 | 시작, 종료 |
| ▭ (사각형) | 업무/처리 | 수행하는 업무 | 수량 검수, 결과 기록 |
| ◇ (마름모) | 분기/판단 | Yes/No 조건 분기 | 수량 일치?, 합격? |
| ▱ (평행사변형) | 입출력 | 문서, 데이터 | 거래명세서, 검수 결과 |

#### 작성 예시 (업무명: 검수)

\`\`\`
        ┌──────────┐
        │   시작   │
        └────┬─────┘
             ↓
        ┌──────────┐
        │거래명세서│
        │  확인    │
        └────┬─────┘
             ↓
        ┌──────────┐
        │ 수량검수 │
        └────┬─────┘
             ↓
           ◇─────────────────┐
         ╱ ╲                 │
        ╱수량╲    NO         │
       ╱일치?╲ ─────────→ ┌──────────┐
       ╲    ╱             │ 구매팀   │
        ╲  ╱              │  통보    │
         ╲╱               └────┬─────┘
          │ YES                │
          ↓                    │
        ┌──────────┐           │
        │ 외관검수 │           │
        └────┬─────┘           │
             ↓                 │
           ◇─────────────────┐│
         ╱ ╲                 ││
        ╱외관╲    NO         ││
       ╱양호?╲ ─────────→────┘│
       ╲    ╱                 │
        ╲  ╱                  │
         ╲╱                   │
          │ YES               │
          ↓                   │
        ┌──────────┐          │
        │검수결과  │          │
        │  기록    │ ←────────┘
        └────┬─────┘
             ↓
        ┌──────────┐
        │   종료   │
        └──────────┘
\`\`\`

#### Flow Chart 상세 테이블 작성 예시

| 순서 | 유형 | 단계명 | 상세 설명 | 분기 조건/비고 |
|-----|-----|-------|----------|--------------|
| 1 | 시작 | 시작 | 검수 프로세스 시작 | - |
| 2 | 업무 | 거래명세서 확인 | 입고예정과 거래명세서 대조 | - |
| 3 | 업무 | 수량 검수 | 실물 수량과 명세서 수량 대조 | - |
| 4 | 분기 | 수량 일치? | 수량 일치 여부 판단 | Y: 외관검수, N: 구매팀 통보 |
| 5 | 업무 | 외관 검수 | 자재 외관 상태 확인 | - |
| 6 | 분기 | 외관 양호? | 외관 상태 판단 | Y: 결과기록, N: 구매팀 통보 |
| 7 | 업무 | 구매팀 통보 | 불일치/불량 내역 구매팀 전달 | 전화 또는 메신저 |
| 8 | 업무 | 검수결과 기록 | 검수 결과를 엑셀에 기록 | 정상/불량 모두 기록 |
| 9 | 종료 | 종료 | 검수 프로세스 완료 | - |

#### 작성 팁

> ✅ **분기점을 명확히 하세요**
> - 분기 조건은 Yes/No로 답할 수 있게 (예: "수량 일치?", "양호?")
> - 각 분기 후 어디로 가는지 화살표로 표시

> ✅ **예외 흐름도 포함하세요**
> - 정상 케이스만 그리면 실제 업무 파악 불가
> - 불합격, 오류, 재작업 등 예외 케이스도 포함

---

### 3.3.3 Swimlane 작성 가이드

#### 기본 구조

\`\`\`
┌────────────┬─────────────────────────────────────────────────────┐
│   담당1    │  업무A ──→ 업무B ──────────────────────────────────→│
├────────────┼─────────────────────────────────────────────────────┤
│   담당2    │            ↓                                        │
│            │          업무C ──→ 업무D ──────────────────────────→│
├────────────┼─────────────────────────────────────────────────────┤
│   담당3    │                       ↓                             │
│            │                     업무E ──→ 업무F ──→ 업무G ────→│
└────────────┴─────────────────────────────────────────────────────┘
                    시간 흐름 ─────────────────────────────→
\`\`\`

#### 작성 예시 (업무명: 입고확정 - 여러 담당자 협업)

\`\`\`
┌────────────┬───────────────────────────────────────────────────────────────┐
│            │                        시간 흐름 →                            │
├────────────┼───────────────────────────────────────────────────────────────┤
│            │ [검수결과   [입고확정] ──→ [라벨발행] ────────────────────────→│
│  창고팀    │   확인] ──→     ↓                                             │
│            │            (입고 데이터)                                       │
├────────────┼───────────────────────────────────────────────────────────────┤
│            │                  ↓                                            │
│  자재팀    │            [ERP 입고처리] ──→ [재고 확인] ───────────────────→│
│            │                                                               │
└────────────┴───────────────────────────────────────────────────────────────┘
\`\`\`

#### 작성 팁

> ✅ **Lane(레인)은 담당 단위로**
> - 부서 단위: 창고팀, 자재팀, 품질팀
> - 또는 역할 단위: 검수담당, 입고담당
> - 섞어 쓰지 말 것 (부서면 부서, 역할이면 역할)

> ✅ **인계 지점을 명확히**
> - 화살표가 Lane을 넘어가는 지점 = 업무 인계
> - 이 지점이 대기/지연 발생 구간인 경우가 많음

---

## 3.4 R&R (역할 및 책임) 정의

### 작성 목적
해당 단위업무에 관여하는 **담당자/부서별 역할과 책임**을 명확히 정의합니다.

### 작성 예시 (업무명: 검수)

| 담당자/부서 | 역할 | 주요 업무/책임 | 비고 |
|------------|-----|--------------|-----|
| 창고팀 박사원 | 검수 담당 | 거래명세서 확인, 수량/외관 검수, 결과 기록 | - |
| 창고팀 김대리 | 검수 확인자 | 검수 결과 확인, 이상 시 판단 | 박사원 부재 시 대행 |
| 구매팀 | 이상 처리 | 수량/품질 불일치 시 협력사 협의 | 통보 받은 후 처리 |

### 작성 팁

> ✅ **실제 담당자를 파악하세요**
> - 공식 R&R과 실제 업무 수행자가 다를 수 있음
> - 인터뷰를 통해 "실제로 누가 하는지" 확인

---

## 3.5 현업 인터뷰 결과

### 작성 목적
현업 담당자로부터 **실제 업무 수행 방식, 어려움, 개선 요청**을 수집합니다.

### 인터뷰 질문 가이드

| 영역 | 질문 예시 |
|-----|----------|
| 현재 업무 수행 방식 | "이 업무를 어떻게 처리하고 계신가요?" |
| 어려운 점/불편사항 | "업무하실 때 가장 불편한 점은?", "자주 발생하는 오류나 실수는?" |
| 개선 요청 사항 | "이렇게 바뀌면 좋겠다 하는 것은?" |

### 작성 예시 (업무명: 검수)

---

**👤 인터뷰 대상**: 창고팀 박사원 (검수 담당)
**📅 일시**: 2025-01-15 14:00

**현재 업무 수행 방식**
> 자재가 도착하면 거래명세서를 받아서 입고예정 목록이랑 대조해요.
> 수량은 직접 세거나 박스 수로 확인하고, 체크리스트에 수기로 기록합니다.
> 외관도 육안으로 확인하고 이상 있으면 바로 사진 찍어둡니다.
> 다 끝나면 검수현황 엑셀에 결과를 입력해요.

**현재 업무의 어려운 점/불편사항**
> - 수기 체크리스트라서 나중에 찾아보기가 어려워요
> - 같은 내용을 체크리스트에 쓰고 또 엑셀에 입력해야 해서 번거로워요
> - 불량 사진을 찍어두는데, 어떤 입고 건이랑 연결되는지 관리가 안 돼요
> - 이전 검수 이력을 보려면 엑셀 파일을 한참 뒤져야 해요

**개선 요청 사항**
> - 바코드 스캔으로 자재 확인하면 빠를 것 같아요
> - 태블릿으로 검수하고 바로 시스템에 저장되면 좋겠어요
> - 검수 이력이 품목별로 조회되면 좋겠어요

---

### 작성 팁

> ✅ **현업의 말 그대로 기록**
> - 정제하지 말고 원래 표현 그대로
> - 나중에 요구사항 도출 시 참고

---

## 3.6 이슈 / Pain Point

### 작성 목적
해당 단위업무의 **문제점, 비효율, 리스크**를 정리합니다.

### 우선순위 기준

| 우선순위 | 기준 |
|---------|------|
| **높음** | 업무 중단/지연 유발, 빈번히 발생, 금전적 손실 |
| **중간** | 효율 저하, 주기적 발생, 업무 불편 |
| **낮음** | 사소한 불편, 가끔 발생, 개선되면 좋은 수준 |

### 작성 예시 (업무명: 검수)

| No | 이슈 내용 | 영향/문제점 | 우선순위 | 출처 | 비고 |
|----|----------|-----------|---------|-----|-----|
| 1 | 수기 체크리스트 → 엑셀 이중 입력 | 입력 시간 과다, 오타 발생 | 높음 | 인터뷰 | |
| 2 | 검수 이력 조회 어려움 | 품목별 불량 이력 파악 불가 | 중간 | 인터뷰 | |
| 3 | 불량 사진과 입고 건 연결 안됨 | 클레임 시 증빙 찾기 어려움 | 중간 | 인터뷰 | |
| 4 | 수량 검수 시 수기 계수 | 대량 입고 시 시간 소요, 오류 가능 | 중간 | 분석 | 바코드/PDA |

### 작성 팁

> ✅ **구체적으로 작성**
> - 나쁜 예: "검수가 불편함"
> - 좋은 예: "수기 체크리스트 작성 후 엑셀에 다시 입력 (건당 5분 추가)"

> ✅ **총괄 템플릿과 연계**
> - 여기서 도출한 이슈 중 핵심만 총괄 템플릿의 "이슈 요약"에 기재

---

## 3.7 조건부 영역

### 3.7.1 (A) 수기/엑셀 기반인 경우

> **작성 조건**: 현행 방식이 "수기", "엑셀", "혼합"인 경우

#### A-1. 사용 문서/양식 목록

**작성 예시 (업무명: 검수)**

| No | 유형 | 문서/파일명 | 용도 | 작성 주기 | 작성자 | 보관 위치 |
|----|-----|-----------|-----|----------|-------|----------|
| 1 | 종이 전표 | 검수 체크리스트 | 수량/외관 검수 기록 | 입고 시 | 창고팀 | 창고 사무실 |
| 2 | 엑셀 | 검수현황_2025.xlsx | 검수 결과 관리 | 수시 | 창고팀 | 공유폴더 |

#### A-2. 엑셀/문서 구조 분석

**작성 예시 (검수현황.xlsx)**

| No | 항목명 | 데이터 유형 | 설명/용도 | 필수 | 비고 |
|----|-------|-----------|----------|-----|-----|
| 1 | 검수일자 | 날짜 | 검수 실시 일자 | Y | YYYY-MM-DD |
| 2 | 입고예정번호 | 문자 | 입고예정 식별자 | Y | |
| 3 | 품목코드 | 문자 | 자재 품목 코드 | Y | |
| 4 | 검수수량 | 숫자 | 검수한 수량 | Y | |
| 5 | 검수결과 | 문자 | 합격/불합격 | Y | |
| 6 | 불량내용 | 문자 | 불합격 시 사유 | N | |
| 7 | 검수자 | 문자 | 검수 담당자 | Y | |

---

### 3.7.2 (B) 기존 시스템 기반인 경우

> **작성 조건**: 현행 방식이 "시스템", "혼합"인 경우

#### B-1 ~ B-5 항목

해당 단위업무에서 사용하는 시스템의 기능, 화면, 인터페이스, 테이블, 코드를 분석하여 작성합니다.
(상세 예시는 구현 지시서 참조)

---

# 4. 작성 순서 및 팁

## 4.1 권장 작성 순서

\`\`\`
1단계: 총괄 템플릿 - 업무 분류 체계 작성
       (단위업무 단위로 전체 목록화)
        ↓
2단계: 단위업무별로 인터뷰 실시
        ↓
3단계: 단위업무 템플릿 작성 (업무명 하나당 1개)
        ├─ 업무 프로세스 정의서 (세부 Step)
        ├─ 업무 프로세스 맵 (Flow Chart / Swimlane)
        ├─ R&R 정의
        ├─ 인터뷰 결과 정리
        ├─ 이슈/Pain Point 도출
        └─ 조건부 영역 (해당 시)
        ↓
4단계: 총괄 템플릿 - 이슈 요약 업데이트
\`\`\`

## 4.2 공통 작성 팁

| 팁 | 설명 |
|---|-----|
| **현재 상태 그대로** | "이렇게 했으면" 아니라 "지금 이렇게" 기록 |
| **구체적으로** | 추상적 표현 지양, 수치/예시 포함 |
| **현업 중심** | 문서상 R&R보다 실제 담당자 파악 |
| **누락 없이** | 사소한 Step, 예외 처리도 포함 |
| **일관된 용어** | 같은 대상은 같은 용어로 |

## 4.3 자주 하는 실수

| 실수 | 올바른 방법 |
|-----|-----------|
| 중분류 단위로 템플릿 작성 | **업무명(단위업무) 단위**로 각각 작성 |
| TO-BE 관점으로 작성 | AS-IS는 현재 상태만 |
| 담당자 1명만 인터뷰 | 관련 담당자 모두 인터뷰 |
| 정상 케이스만 기록 | 예외/오류 케이스도 포함 |
| 이슈를 모호하게 기술 | 구체적 상황/영향/빈도 포함 |

---

# 📎 부록

## 용어 정의

| 용어 | 정의 |
|-----|------|
| AS-IS | 현재 상태 (Current State) |
| TO-BE | 미래 상태 (Future State) |
| 대분류 | 업무 영역 (예: 자재관리, 생산관리) |
| 중분류 | 업무 그룹 (예: 입고관리, 출고관리) |
| **업무명 (단위업무)** | **분석 및 템플릿 작성 단위** (예: 입고예정등록, 검수) |
| 세부 Step | 단위업무 내의 상세 작업 |
| R&R | Roles & Responsibilities (역할과 책임) |
| Pain Point | 업무 수행 시 겪는 어려움/불편 |

## 체크리스트

### 총괄 템플릿 체크리스트
- [ ] 프로젝트 기본 정보 작성 완료
- [ ] 모든 단위업무(업무명) 목록화 완료 (1행 = 1업무)
- [ ] 각 업무별 현행 방식 확인 완료
- [ ] 단위업무 템플릿 연결 완료
- [ ] 이슈 요약 작성 완료

### 단위업무 템플릿 체크리스트
- [ ] 대상 업무 정보 (대분류, 중분류, **업무명**, 현행방식) 작성 완료
- [ ] 업무 프로세스 정의서 (세부 Step) 작성 완료
- [ ] Flow Chart 또는 Swimlane 작성 완료
- [ ] R&R 정의 완료
- [ ] 인터뷰 실시 및 결과 정리 완료
- [ ] 이슈/Pain Point 도출 완료
- [ ] 조건부 영역 작성 완료 (해당 시)

---

**문서 버전**: v2.0
**최종 수정일**: 2025-01-18
**작성자**: PMO

**핵심 변경사항 (v1.0 → v2.0)**:
- 기존: 중분류 단위로 단위업무 템플릿 1개 작성
- 변경: **업무명(단위업무) 단위로 단위업무 템플릿 각각 1개씩 작성**
`;

/**
 * AS-IS 분석 작성 가이드 모달 컴포넌트
 */
export function WritingGuideModal({ onClose }: WritingGuideModalProps) {
  // ESC 키로 모달 닫기
  useEffect(() => {
    const handleKeyDown = (e: KeyboardEvent) => {
      if (e.key === "Escape") {
        onClose();
      }
    };
    document.addEventListener("keydown", handleKeyDown);
    return () => document.removeEventListener("keydown", handleKeyDown);
  }, [onClose]);

  // 스크롤 방지
  useEffect(() => {
    document.body.style.overflow = "hidden";
    return () => {
      document.body.style.overflow = "unset";
    };
  }, []);

  return (
    <div className="fixed inset-0 z-50 flex items-center justify-center">
      {/* 오버레이 */}
      <div
        className="absolute inset-0 bg-black/60 backdrop-blur-sm"
        onClick={onClose}
      />

      {/* 모달 */}
      <div className="relative bg-background-white dark:bg-surface-dark rounded-xl shadow-2xl w-full max-w-5xl mx-4 max-h-[90vh] flex flex-col">
        {/* 헤더 */}
        <div className="flex items-center justify-between px-6 py-4 border-b border-border dark:border-border-dark flex-shrink-0">
          <div className="flex items-center gap-3">
            <div className="size-10 rounded-full bg-primary/10 flex items-center justify-center">
              <Icon name="menu_book" size="sm" className="text-primary" />
            </div>
            <div>
              <h2 className="text-lg font-bold text-text dark:text-white">
                AS-IS 분석 작성 가이드
              </h2>
              <p className="text-sm text-text-secondary">
                템플릿 작성 방법 및 예시
              </p>
            </div>
          </div>
          <button
            onClick={onClose}
            className="p-2 rounded-lg hover:bg-surface dark:hover:bg-background-dark transition-colors"
            title="닫기 (ESC)"
          >
            <Icon name="close" size="sm" className="text-text-secondary" />
          </button>
        </div>

        {/* 본문 - 스크롤 영역 */}
        <div className="flex-1 overflow-y-auto p-6">
          <div className="prose prose-slate dark:prose-invert max-w-none
            prose-headings:font-bold
            prose-h1:text-2xl prose-h1:border-b prose-h1:border-border prose-h1:dark:border-border-dark prose-h1:pb-3 prose-h1:mb-4
            prose-h2:text-xl prose-h2:mt-8 prose-h2:mb-4
            prose-h3:text-lg prose-h3:mt-6 prose-h3:mb-3
            prose-h4:text-base prose-h4:mt-4 prose-h4:mb-2
            prose-p:text-sm prose-p:leading-relaxed
            prose-table:text-sm
            prose-th:bg-surface prose-th:dark:bg-background-dark prose-th:px-3 prose-th:py-2 prose-th:text-left prose-th:font-semibold
            prose-td:px-3 prose-td:py-2 prose-td:border-b prose-td:border-border prose-td:dark:border-border-dark
            prose-code:text-primary prose-code:bg-primary/10 prose-code:px-1.5 prose-code:py-0.5 prose-code:rounded prose-code:text-sm prose-code:before:content-[''] prose-code:after:content-['']
            prose-pre:bg-slate-900 prose-pre:text-slate-100 prose-pre:p-4 prose-pre:rounded-lg prose-pre:overflow-x-auto prose-pre:text-xs
            prose-blockquote:border-l-4 prose-blockquote:border-primary prose-blockquote:bg-primary/5 prose-blockquote:px-4 prose-blockquote:py-2 prose-blockquote:not-italic prose-blockquote:text-sm
            prose-strong:text-primary
            prose-hr:my-6 prose-hr:border-border prose-hr:dark:border-border-dark
            prose-ul:text-sm prose-ol:text-sm
            prose-li:my-1
          ">
            <ReactMarkdown remarkPlugins={[remarkGfm]}>
              {GUIDE_CONTENT}
            </ReactMarkdown>
          </div>
        </div>

        {/* 푸터 */}
        <div className="flex items-center justify-end gap-2 px-6 py-4 border-t border-border dark:border-border-dark flex-shrink-0">
          <Button variant="primary" onClick={onClose}>
            확인
          </Button>
        </div>
      </div>
    </div>
  );
}
